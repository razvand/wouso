{% extends 'interface/section_base.html'%}

{% load i18n %}

{% block title %}
    {{ lesson.name }}
{% endblock %}

{% block scripts %}
    {{ block.super }}

    <script type="text/javascript" src="{{ basepath }}/static/js/timer.js"></script>

    <script id="timer_script" language="javascript">
        var seconds = {{ lesson.quiz_show_time }} * 60;
        $(document).ready(function () { update('timer');});
        setTimeout(function() {
            $('#quizbutton').prop('disabled', false);
            $('#quizbutton').removeClass('disabled');
        }, seconds * 1000);
    </script>

{% endblock %}

{% block sectioncontent %}

    <h3>{{ lesson.category }}</h3>

    <hr class="thin" />

    <p>
    {{ lesson.content|safe }}
    </p>

    {% if lesson.youtube_url %}
    <iframe width="853" height="480" src="{{ embed_url }}?vq=large" frameborder="0" allowfullscreen></iframe>
    {% endif %}

    {% if through %}
        {% if through.is_running %}
            <div>
                <p>The quiz is already running!</p>
                <a href="{% url quiz_view lesson.quiz.id %}">
                    <button type="button">Back to Quiz!</button>
                </a>
            </div>
        {% elif not through.can_play_again %}
            <p>You can replay this quiz in {{ through.days_until_can_replay }} day(s).</p>
            <a href="{% url quiz_view lesson.quiz.id %}">
                <button class="disabled" type="button" disabled>Start Quiz!</button>
            </a>
        {% else %}
            <div>Quiz enabled in: <p style="display: inline;" id="timer"></p></div>
            <a href="{% url quiz_view lesson.quiz.id %}">
                <button id="quizbutton" class="disabled" type="button" disabled>Start Quiz!</button>
            </a>
        {% endif %}
     {% endif %}

{% endblock %}
